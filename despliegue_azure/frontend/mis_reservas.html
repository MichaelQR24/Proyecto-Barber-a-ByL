<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mis Reservas - Barbería ByL</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Header / Navbar -->
    <header class="site-header">
      <nav class="nav container">
        <a class="brand" href="index.html" aria-label="Volver al inicio">
          <span class="logo" aria-hidden="true">
            <!-- Scissors logo (inline SVG) -->
            <svg viewBox="0 0 24 24" width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7.5 8.25a2.25 2.25 0 1 0 0-4.5 2.25 2.25 0 0 0 0 4.5Zm0 0L12 12m0 0 6.75 6.75m0 0a2.25 2.25 0 1 0 3.182-3.182M18.75 18.75 21 21m-9-9L5.25 15.75m0 0a2.25 2.25 0 1 0 3.182 3.182" stroke="#f1b41f" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="brand-text">Barbería ByL</span>
        </a>

        <button class="nav-toggle" aria-controls="navLinks" aria-expanded="false" aria-label="Abrir menú">
          <span></span><span></span><span></span>
        </button>

        <ul class="nav-links" id="navLinks">
          <li><a href="index.html#inicio">Inicio</a></li>
          <li><a href="index.html#quienes">Quiénes Somos</a></li>
          <li><a href="index.html#servicios">Servicios</a></li>
          <li><a href="index.html#productos">Productos</a></li>
          <li><a href="index.html#ubicacion">Ubicación</a></li>
          <li><a href="index.html#reserva">Reserva</a></li>
        </ul>

        <a href="#" class="btn btn-login" id="logoutBtn">
          <span class="icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13 5l7 7-7 7M20 12H4" stroke="#1a1202" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="btn-text">Cerrar Sesión</span>
        </a>
      </nav>
    </header>

    <!-- Mis Reservas -->
    <main class="section" style="padding-top: 120px;">
      <div class="container">
        <header class="section-head">
          <h2>Mis Reservas</h2>
          <p>Consulta y gestiona tus reservas realizadas</p>
        </header>

        <div class="booking-card">
          <div id="reservas-container">
            <p class="center">Cargando tus reservas...</p>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
      <div class="container footer-grid">
        <div class="footer-brand">
          <div class="f-brand">
            <span class="logo" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7.5 8.25a2.25 2.25 0 1 0 0-4.5 2.25 2.25 0 0 0 0 4.5Zm0 0L12 12m0 0 6.75 6.75m0 0a2.25 2.25 0 1 0 3.182-3.182M18.75 18.75 21 21m-9-9L5.25 15.75m0 0a2.25 2.25 0 1 0 3.182 3.182" stroke="#f1b41f" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="brand-text">Barbería ByL</span>
          </div>
          <p>Tu destino para el cuidado personal masculino con estilo y profesionalismo.</p>
        </div>

        <div class="footer-contact">
          <h3>Contacto</h3>
          <ul class="contact-list" role="list">
            <li>Calle Principal #123</li>
            <li>Centro, Ciudad</li>
            <li>+51 999 888 7777</li>
            <li><a href="mailto:contacto@barberiabyl.com">contacto@barberiabyl.com</a></li>
          </ul>
        </div>

        <div class="footer-social">
          <h3>Síguenos</h3>
          <div class="socials">
            <a href="#" aria-label="Facebook" class="social">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 3h-2a4 4 0 0 0-4 4v3H6v3h3v8h3v-8h3l1-3h-4V7a1 1 0 0 1 1-1h3V3z" fill="#fff"/></svg>
            </a>
            <a href="#" aria-label="Instagram" class="social">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="5" stroke="#fff" stroke-width="1.6"/><circle cx="12" cy="12" r="3.5" stroke="#fff" stroke-width="1.6"/><circle cx="17.5" cy="6.5" r="1" fill="#fff"/></svg>
            </a>
            <a href="#" aria-label="Twitter" class="social">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 5.9a7 7 0 0 1-2 .55 3.5 3.5 0 0 0 1.54-1.93 7 7 0 0 1-2.22.85 3.5 3.5 0 0 0-6 3.19A9.9 9.9 0 0 1 3.6 4.7a3.5 3.5 0 0 0 1.08 4.67 3.4 3.4 0 0 1-1.58-.44v.04A3.5 3.5 0 0 0 6.5 12a3.6 3.6 0 0 1-.92.12c-.22 0-.45-.02-.66-.06a3.5 3.5 0 0 0 3.27 2.43A7 7 0 0 1 2 16.9a9.9 9.9 0 0 0 5.35 1.57c6.42 0 9.93-5.32 9.93-9.93v-.46A7.1 7.1 0 0 0 22 5.9Z" fill="#fff"/></svg>
            </a>
          </div>
        </div>
      </div>
      <div class="footer-line"></div>
      <div class="container footer-copy">© 2025 Barbería ByL. Todos los derechos reservados.</div>
    </footer>

    <script src="js/api.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        // Verificar si el usuario está autenticado
        const token = localStorage.getItem('token');
        if (!token) {
          alert('Debes iniciar sesión para ver tus reservas');
          window.location.href = 'index.html';
          return;
        }

        // Manejar logout
        const logoutBtn = document.getElementById('logoutBtn');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', (e) => {
            e.preventDefault();
            apiClient.logout();
            alert('Sesión cerrada exitosamente');
            window.location.href = 'index.html';
          });
        }

        try {
          const { reservas } = await apiClient.getReservas();
          const container = document.getElementById('reservas-container');
          
          if (reservas.length === 0) {
            container.innerHTML = '<p class="center">No tienes reservas realizadas aún.</p>';
            return;
          }
          
          let html = '<div class="table-wrap"><table class="admin-table"><thead><tr><th>ID</th><th>Servicio</th><th>Fecha</th><th>Hora</th><th>Estado</th></tr></thead><tbody>';
          
          reservas.forEach(reserva => {
            let estadoClass = '';
            if (reserva.estado === 'completada') estadoClass = 'chip-green';
            else if (reserva.estado === 'en proceso') estadoClass = 'chip-blue';
            else if (reserva.estado === 'cancelada') estadoClass = 'chip-red';
            else estadoClass = 'chip-yellow';
            
            html += `
              <tr>
                <td>${reserva.id}</td>
                <td>${reserva.servicio_nombre || 'Servicio'}</td>
                <td>${reserva.fecha}</td>
                <td>${reserva.hora}</td>
                <td class="status"><span class="chip ${estadoClass}">${reserva.estado}</span></td>
              </tr>
            `;
          });
          
          html += '</tbody></table></div>';
          container.innerHTML = html;
        } catch (error) {
          console.error('Error al cargar reservas:', error);
          document.getElementById('reservas-container').innerHTML = '<p class="center">Error al cargar tus reservas. Por favor, intenta de nuevo más tarde.</p>';
        }
      });
    </script>
  </body>
</html>